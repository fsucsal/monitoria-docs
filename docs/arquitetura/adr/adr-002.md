# ADR-002 — Estilo de Comunicação: REST com OpenAPI

**Status:** Aprovado

---

## Contexto

O sistema será desenvolvido por equipes de **frontend e backend em paralelo**, exigindo um **contrato de comunicação claro, estável e versionado** para garantir integração contínua e reduzir retrabalho.

Características do contexto:

- Time majoritariamente iniciante
- Backend baseado em **Spring**
- Frontend em **React ou Angular**
- Necessidade de:

  - Simplicidade arquitetural
  - Padronização
  - Facilidade de depuração
  - Adoção de padrões amplamente conhecidos no mercado

Além disso, a API precisa servir como **fonte única de verdade** para:

- Desenvolvimento do frontend
- Testes manuais e automatizados
- Integrações futuras

---

## Decisão

Adotar **APIs RESTful documentadas via OpenAPI (Swagger)** como **padrão oficial de comunicação** entre frontend e backend.

A API será tratada como um **contrato formal**, com versionamento explícito e regras claras de evolução.

### Diretrizes principais

- Todas as APIs devem seguir o padrão **REST**
- Toda API deve ser documentada via **OpenAPI (Swagger)**
- O versionamento será feito no formato:

```
/api/v1
```

- O Swagger será utilizado como:

  - Contrato oficial da API
  - Ferramenta de testes manuais
  - Referência técnica para o frontend

- Nenhuma funcionalidade será considerada pronta sem:

  - Endpoint implementado
  - Contrato documentado
  - DTOs de entrada e saída definidos

O **OpenAPI é a autoridade máxima sobre o comportamento da API**.

---

## Alternativas Consideradas

- **GraphQL**
- **RPC / gRPC**
- **Comunicação sem contrato formal**

Essas alternativas foram descartadas por:

- Introduzirem complexidade desnecessária para o momento do projeto
- Exigirem maior maturidade técnica do time
- Dificultarem o aprendizado e a depuração
- Aumentarem o custo cognitivo e operacional

---

## Consequências

### Positivas

- Padrão amplamente adotado no mercado
- Baixa curva de aprendizado
- Alta compatibilidade com ferramentas de frontend, testes e documentação
- Facilidade de testes manuais via Swagger
- Permite desenvolvimento paralelo entre frontend e backend
- Facilita testes de integração e contratos

### Negativas

- Possibilidade de overfetch em alguns cenários
- Necessidade de disciplina no versionamento
- Evoluções de contrato podem exigir múltiplas versões da API

---

## Diretrizes de Implementação

### Endpoints

- Usar corretamente os verbos HTTP:

  - `GET` → Consulta
  - `POST` → Criação
  - `PUT` / `PATCH` → Atualização
  - `DELETE` → Remoção

- Retornar **status HTTP coerentes**

- Nunca expor entidades diretamente

- Sempre utilizar **DTOs de entrada e saída**

---

### Versionamento

- Alterações compatíveis:

  - Podem ser feitas dentro da mesma versão

- Alterações que quebram contrato:

  - Devem gerar **nova versão da API**
  - Nunca devem quebrar clientes existentes

---

### Documentação

- Todo endpoint deve estar documentado no Swagger
- Exemplos de request e response devem ser claros
- Erros devem estar documentados (status + payload)

---

## Relação com Outros Documentos

Este ADR se relaciona diretamente com:

- `api/openapi-v1.yaml`
- `api/v1.md`
- Guia de Padrões de Desenvolvimento Backend
- Padrões de Controllers
- Tratamento de Exceções e Erros

---

## Considerações Finais

O uso de **REST com OpenAPI** garante um equilíbrio entre:

- Simplicidade
- Clareza
- Padronização
- Evolução controlada

Esse padrão sustenta o crescimento do projeto sem comprometer a qualidade ou o aprendizado do time.
