# ADR-015 — Recuperação de Senha: reset com token e expiração

**Status:** Aprovado

## Contexto

O sistema possui autenticação própria baseada em usuário e senha. É necessário permitir que usuários recuperem o acesso de forma segura caso esqueçam a senha.

Esse processo envolve:

- Geração de token seguro
- Envio por e-mail
- Definição de tempo de expiração
- Troca segura da senha

Como o sistema lida com dados sensíveis e emissão de certificados, o processo de recuperação deve seguir **boas práticas de segurança de mercado**.

---

## Decisão

A recuperação de senha será implementada com o seguinte fluxo:

1. Usuário solicita recuperação de senha informando e-mail
2. O sistema gera um **token único, aleatório e seguro**
3. O token é:
   - Associado ao usuário
   - Armazenado de forma segura
   - Possui **tempo de expiração**
4. O link de recuperação é enviado por **e-mail**
5. O usuário cadastra uma nova senha
6. O token é invalidado após o uso

Diretrizes obrigatórias:

- Token de uso único
- Token com tempo de vida limitado (ex: 15 a 60 minutos)
- A nova senha deve seguir a **Política de Senhas do sistema**
- Após a redefinição, todas as sessões anteriores devem ser invalidadas

---

## Alternativas Consideradas

- Recuperação por perguntas secretas
- Envio da senha original por e-mail
- Tokens sem expiração

---

## Consequências

- ✅ Alto nível de segurança
- ✅ Proteção contra reutilização de tokens
- ✅ Processo compatível com boas práticas de mercado
- ✅ Integração direta com autenticação JWT
- ❌ Exige implementação de envio de e-mail
- ❌ Adiciona fluxo adicional de validação

---
