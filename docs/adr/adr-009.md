# ADR-009 — Observabilidade: logs estruturados, métricas e rastreabilidade

**Status:** Aprovado

## Contexto

O sistema será desenvolvido por uma equipe acadêmica, com múltiplos módulos, execução assíncrona (ex: geração de certificados) e futura possibilidade de extração de microsserviços.

É necessário garantir:

- Rastreabilidade de erros
- Auditoria de ações sensíveis (inscrições, geração de certificados, autenticação)
- Visibilidade de desempenho
- Base sólida para diagnóstico em produção no futuro

Ao mesmo tempo, a solução deve ser **progressiva**, sem excessiva complexidade inicial.

---

## Decisão

Adotar uma estratégia de observabilidade baseada em três pilares:

### 1. Logs Estruturados

- Logs em **JSON**
- Padronização de:
  - `timestamp`
  - `level`
  - `service`
  - `traceId`
  - `userId` (quando aplicável)
- Separação por nível:
  - INFO, WARN, ERROR, DEBUG

### 2. Métricas de aplicação

- Exposição de métricas via **endpoint padrão** (`/actuator/prometheus` no Spring)
- Coleta futura via **Prometheus**
- Monitoramento de:
  - Tempo de resposta
  - Erros por rota
  - Execução de jobs assíncronos
  - Uso de recursos

### 3. Rastreabilidade (Tracing)

- Preparação para uso de **OpenTelemetry**
- Correlação de requisições com:
  - Jobs assíncronos
  - Processamento de certificados
- Inicialmente opcional no ambiente acadêmico, obrigatório em produção

A observabilidade será implementada de forma **incremental**, respeitando o nível de maturidade da equipe.

---

## Alternativas Consideradas

- Apenas logs simples em console ou arquivo
- Monitoramento apenas manual via debug

---

## Consequências

- ✅ Diagnóstico rápido de erros e falhas
- ✅ Suporte a processamento assíncrono e filas
- ✅ Base pronta para futura extração de microsserviços
- ✅ Auditoria de ações críticas
- ✅ Melhora na confiabilidade do sistema
- ❌ Aumenta levemente a complexidade inicial
- ❌ Exige disciplina na padronização dos logs
